<div class="driver-container">
  <!-- Show active ride component when ride is active -->
  <app-driver-active-ride *ngIf="showActiveRide" [activeRide]="activeRide" (rideCompleted)="onRideCompleted()"
    (rideCancelled)="onRideCancelled()">
  </app-driver-active-ride>

  <!-- Show default map when no active ride -->
  <app-map *ngIf="!showActiveRide" class="map"></app-map>

  <!-- TOP INFO BAR -->
  <div class="top-bar" *ngIf="!showActiveRide">
    <div class="wallet">
      <span>VND</span>
      <strong>900.000</strong>
    </div>
    <!-- DRIVER AVATAR -->
    <div class="driver-avatar" (click)="goToProfile()">
      <img [src]="driverAvatar" alt="Driver Avatar" />
    </div>
  </div>

  <!-- CENTER MESSAGE -->
  <div class="status-message" *ngIf="!isOnline && !showActiveRide">
    Nhấn để bật/tắt chế độ<br />
    <b>sẵn sàng & tự động nhận cuốc</b>
  </div>

  <!-- POWER BUTTON -->
  <button *ngIf="!showActiveRide" class="power-btn" [class.online]="isOnline" (click)="toggleOnline()">
    {{ isOnline ? 'Đang kết nối' : 'Bật kết nối' }}
  </button>

  <!-- STATUS BAR -->
  <div class="status-bar" *ngIf="!showActiveRide">
    {{ isOnline ? 'Bạn đang sẵn sàng nhận cuốc.' : 'Bạn đang không sẵn sàng nhận cuốc.' }}
  </div>
</div>

<!-- Driver Ride Request Modal -->
<app-driver-notification-modal [isVisible]="showRideRequestModal" [rideRequest]="currentRideRequest"
  (accept$)="onAcceptRide($event)" (reject$)="onRejectRide($event)" (timeout$)="onRideRequestTimeout($event)">
</app-driver-notification-modal>